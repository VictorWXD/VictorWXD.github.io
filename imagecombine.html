<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>图像拼接与下载</title>
<style>
  .image-container {
    position: relative;
    width: 1024px;
    height: 1024px;
  }
  .image-part {
    position: absolute;
    width: 1024px;
    height: 256px;
    background-size: 1024px 1024px;
  }
</style>
</head>
<body>

<input type="file" id="imageUpload" accept="image/*" multiple>
<div class="image-container" id="imageContainer"></div>
<button id="downloadButton">下载图像</button>

<script>
  document.getElementById('imageUpload').addEventListener('change', function(event) {
    var files = event.target.files;
    if(files.length !== 4) {
      alert('请上传四个被竖直切分的图像片段。');
      return;
    }
    var container = document.getElementById('imageContainer');
    container.innerHTML = ''; // 清空容器中的内容
    for (var i = 0; i < files.length; i++) {
      (function(file, index) {
        var reader = new FileReader();
        reader.onload = function(e) {
          var part = document.createElement('div');
          part.className = 'image-part';
          part.style.backgroundImage = 'url(' + e.target.result + ')';
          part.style.backgroundPosition = '0 ' + (-256 * index) + 'px';
          container.appendChild(part);
        };
        reader.readAsDataURL(file);
      })(files[i], i);
    }
  });

  document.getElementById('downloadButton').addEventListener('click', function() {
    var container = document.getElementById('imageContainer');
    html2canvas(container).then(function(canvas) {
      var link = document.createElement('a');
      link.download = 'complete_image.png';
      link.href = canvas.toDataURL();
      link.click();
    });
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

</body>
</html>