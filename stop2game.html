<!DOCTYPE html>
<html>
<head>
<title>A stroke of the UON logo</title>
<style>
  canvas {
    border: 1px solid #000;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="400"></canvas>

<script>
  var canvas = document.getElementById('gameCanvas');
  var ctx = canvas.getContext('2d');
  var points = [{x: 50, y: 50}, {x: 150, y: 100}, {x: 100, y: 200}];
  var isDragging = false;
  var dragPointIndex = -1;
  var img = new Image();
  img.onload = function() {
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    drawPoints();
    connectPoints(); 
  };
  img.src = 'https://raw.githubusercontent.com/VictorWXD/VictorWXD.github.io/main/css/images/logo.jpg';

  function drawPoints() {
    for (var i = 0; i < points.length; i++) {
      ctx.beginPath();
      ctx.arc(points[i].x, points[i].y, 5, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  function connectPoints() {
    ctx.beginPath();
    for (var i = 0; i < points.length; i++) {
      ctx.lineTo(points[i].x, points[i].y);
    }
    ctx.stroke();
  }

  function checkMouseOnPoint(x, y) {
    for (var i = 0; i < points.length; i++) {
      var dx = points[i].x - x;
      var dy = points[i].y - y;
      if (dx * dx + dy * dy < 25) {
        return i;
      }
    }
    return -1;
  }

  canvas.onmousedown = function(e) {
    var rect = canvas.getBoundingClientRect();
    var x = e.clientX - rect.left;
    var y = e.clientY - rect.top;
    dragPointIndex = checkMouseOnPoint(x, y);
    if (startPointIndex !== -1) {
      isDrawing = true;
      ctx.beginPath();
      ctx.moveTo(points[startPointIndex].x, points[startPointIndex].y);
    }
  };

  canvas.onmousemove = function(e) {
    if (isDrawing) {
      var rect = canvas.getBoundingClientRect();
      var x = e.clientX - rect.left;
      var y = e.clientY - rect.top;
      ctx.lineTo(x, y);
      ctx.stroke();
    }
  };

  canvas.onmouseup = function(e) {
    isDragging = false;
    var rect = canvas.getBoundingClientRect();
    var x = e.clientX - rect.left;
    var y = e.clientY - rect.top;
    var endPointIndex = checkMouseOnPoint(x, y);
    if (endPointIndex !== -1 && startPointIndex !== endPointIndex) {
      ctx.lineTo(points[endPointIndex].x, points[endPointIndex].y);
      ctx.stroke();
      startPointIndex = endPointIndex;
    }
    if (isOneStrokeComplete()) {
      window.location.href = 'https://victorwxd.github.io/stop2intro';
    }
  };


  function isOneStrokeComplete() {
  var visited = new Array(points.length).fill(false);
  var totalVisited = 0;

  visited[0] = true;
  totalVisited++;

  for (var i = 1; i < points.length; i++) {
    if (!visited[i] && isNextPoint(points[i-1], points[i])) {
      visited[i] = true;
      totalVisited++;
    }
  }

  return totalVisited === points.length;
}

function isNextPoint(a, b) {
  var dx = a.x - b.x;
  var dy = a.y - b.y;
  var distance = Math.sqrt(dx * dx + dy * dy);

  var threshold = 10; 
  return distance < threshold;
}

  drawPoints();
  connectPoints();
</script>

</body>
</html>