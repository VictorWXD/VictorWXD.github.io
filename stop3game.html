<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>拼图游戏</title>
<style>
  #puzzle-container {
    width: 300px;
    height: 300px;
    position: relative;
    background-color: white;
    border: 1px solid #000;
  }
  .puzzle-piece {
    width: 100px;
    height: 100px;
    position: absolute;
    background-image: url('https://raw.githubusercontent.com/VictorWXD/VictorWXD.github.io/main/css/images/logo.jpg');
    background-size: 300px 300px;
    cursor: pointer;
  }
</style>
</head>

<body>

<div id="puzzle-container">
    
</div>
    
<script>
var pieces = [],
    container = document.getElementById('puzzle-container'),
    imgUrl = 'https://raw.githubusercontent.com/VictorWXD/VictorWXD.github.io/main/css/images/logo.jpg';
var correctPositions = 0,
    redirectUrl = 'https://victorwxd.github.io/stop3intro';


function createPieces() {
  for (var i = 0; i < 9; i++) {
    var piece = document.createElement('div');
    piece.classList.add('puzzle-piece');
    piece.style.backgroundPosition = '-' + (i % 3 * 100) + 'px -' + (Math.floor(i / 3) * 100) + 'px';
    piece.setAttribute('data-index', i);
    container.appendChild(piece);
    pieces.push(piece);
  }
}

function checkPosition(piece, index) {
    var correctX = index % 3 * 100,
        correctY = Math.floor(index / 3) * 100;
    var currentX = parseInt(piece.style.left, 10),
        currentY = parseInt(piece.style.top, 10);
    if (Math.abs(currentX - correctX) <= 10 && Math.abs(currentY - correctY) <= 10) {
    piece.style.left = correctX + 'px';
    piece.style.top = correctY + 'px';
    piece.removeEventListener('mousedown', onPieceMouseDown);
    correctPositions++;
    if (correctPositions === 9) {
      window.location.href = redirectUrl;
    }
  }
}

function onPieceMouseDown(e) {
  var selectedPiece = this;
  var x = e.clientX - selectedPiece.getBoundingClientRect().left,
      y = e.clientY - selectedPiece.getBoundingClientRect().top;

  function movePiece(e) {
    selectedPiece.style.left = e.clientX - x + 'px';
    selectedPiece.style.top = e.clientY - y + 'px';
  }

  function dropPiece(e) {
    document.removeEventListener('mousemove', movePiece);
    document.removeEventListener('mouseup', dropPiece);
    checkPosition(selectedPiece, parseInt(selectedPiece.getAttribute('data-index'), 10));
  }

  document.addEventListener('mousemove', movePiece);
  document.addEventListener('mouseup', dropPiece);
}

pieces.forEach(function(piece) {
  piece.addEventListener('mousedown', onPieceMouseDown);
});

window.onload = createPieces;
</script>

</body>
</html>