<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>图像拼接与下载</title>
<style>
  .image-container {
    position: relative;
    width: 1024px; /* 设置为原图像的宽度 */
    height: 1024px; /* 设置为原图像的高度 */
    display: flex;
    flex-direction: column;
  }
  .image-part {
    width: 1024px; /* 设置为原图像的宽度 */
    height: 256px; /* 设置为原图像高度的四分之一 */
    background-size: 1024px 1024px;
    background-repeat: no-repeat;
  }
</style>
</head>
<body>

<input type="file" id="imageUpload" accept="image/*" multiple>
<div class="image-container" id="imageContainer"></div>
<button id="downloadButton">下载图像</button>

<script>
  document.getElementById('imageUpload').addEventListener('change', function(event) {
    var files = event.target.files;
    if(files.length !== 4) {
      alert('请上传四个被竖直切分的图像片段。');
      return;
    }
    var container = document.getElementById('imageContainer');
    container.innerHTML = ''; // 清空容器中的内容
    Array.from(files).sort(function(a, b) {
      // 根据文件名排序
      return a.name.localeCompare(b.name);
    }).forEach(function(file, index) {
      var reader = new FileReader();
      reader.onload = function(e) {
        var part = document.createElement('div');
        part.className = 'image-part';
        part.style.backgroundImage = 'url(' + e.target.result + ')';
        container.appendChild(part);
      };
      reader.readAsDataURL(file);
    });
  });

  document.getElementById('downloadButton').addEventListener('click', function() {
    var container = document.getElementById('imageContainer');
    html2canvas(container, {scrollY: -window.scrollY}).then(function(canvas) {
      var link = document.createElement('a');
      link.download = 'complete_image.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

</body>
</html>